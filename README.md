# VRGuitar

## システム概要
ストローク動作の練習ができるVRエアギターシステム．
機械学習により，ユーザーがエアギターをしているときの腕のストローク動作を自動評価し，アドバイスをフィードバックする．
Focus3(VRヘッドセット)とVIVE リストトラッカーを装着して利用する．
![システム概要](https://github.com/kaz-0704/VRGuitar/assets/72312199/3b3ad1e0-c165-453e-8c75-1ae171d4ab55)

## デモ動画
https://user-images.githubusercontent.com/72312199/225524001-bed490b8-5d7f-444d-956e-bd51fd85f80a.mp4

## データセット
### データ概要
- データ：リアルのギターを演奏しているときの腕のモーションデータ
- ラベル：演奏に対する評価
- 長さ：6秒
- フレーム数：512

### データ収集方法
10人の被験者に，以下に示すようなストローク（弦を弾くリズムのパターン）でギターを演奏してもらい，演奏中の右腕のモーションデータと正面からの映像，音を記録した．
![stroke](https://github.com/kaz-0704/VRGuitar/assets/72312199/36afc458-3c30-4d9b-8dd0-1b08d13bc348)
モーションデータを取るためのトラッカーは，右腕の手首，手の甲，前腕に装着した．実際にアプリとして動作させるときは，トラッカーの装着の手間を考えてひとつのトラッカーだけを用いることを想定している．一部位ごとのデータでモデルを学習させ、手首のデータを学習させたときにモデルの性能が最もよくなったため，アプリとして利用するときにはトラッカーは手首に装着することにする．

#### 被験者
大学４年生１０名
##### 被験者のギター歴
- ５年以上：４名
- ２年以上５年未満：２名
- ２年未満：２名
- 未経験：２名

#### データ収集環境
Unityを用いて自動データ収集システムを作成．
https://github.com/kaz-0704/DataCollectingSystem-VRGuitar
![自動データ収集システムの流れ](https://github.com/kaz-0704/VRGuitar/assets/72312199/61dacdec-4d3b-4212-a299-4c6bc51e3f16)

### ラベル付け
ギター経験5年以上の4人の大学4年生に，演奏を以下の4つの観点から評価してもらい，5段階で点数をつけてもらった．その後、評価の一致度を測るカッパ係数に基づき、評価の傾向が大きく違っているような評価者は除外したうえで、評価の平均をとり、最終的なラベルとした。（結果的に，ひとつのデータに4つのラベルがつくことになる．）
#### 評価の観点
- リズム
- 手首の振り
- 手首のひねり
- 腕の振り
#### アノテーションツール
ラベル付けを行うためのツールを、Pythonを用いて作成した．
![アノテーションツール画面](https://github.com/kaz-0704/VRGuitar/assets/72312199/731f6916-32be-4577-a262-a46e87018f64)

#### ラベルの分布
以下が4人の評価者A, B, C, Dの評価項目のラベルの分布図．
![スコア分布_匿名](https://github.com/kaz-0704/VRGuitar/assets/72312199/dc7901ec-f7a0-4e99-96e3-3cdd91e926a2)
5クラス分類では予測精度がそこまで上がらなかったため，クラスを統合してデータを3クラスに分けなおした．クラスには評価スコア1~5があり，となり合うスコアを統合する形で3クラスにした．クラス間のデータ数の偏りが最も小さくなるようにクラスを設定した．3クラスにしたときのラベルの分布は以下のようになった．
![スコア分布_３クラス(音なし)](https://github.com/kaz-0704/VRGuitar/assets/72312199/d7eeeb27-3d77-4910-826a-79628c60b778)

## ストローク動作の自動評価モデル
４つのそれぞれの評価の観点におけるスコア（3段階）を予測するモデルを作成した（計4つのモデルを作成）．
512フレームある腕のモーションデータを入力として受け取り，一つの評価観点におけるスコアの予測値を出力する．
![ストローク評価モデルの構造](https://github.com/kaz-0704/VRGuitar/assets/72312199/8221cb9a-ce93-4f68-afd7-8a999f8d687f)

## モデルの性能評価
### リズムを評価するモデル
評価スコアが3点以下，4点，5点の3クラスで分類を行った．
![リズムモデルの性能](https://github.com/kaz-0704/VRGuitar/assets/72312199/58559174-909a-4aa9-b436-7574a9d94be4)

### 手首のひねりを評価するモデル
評価スコアが1-2点，3-4点，5点の3クラスで分類を行った．
![手首のひねりの性能](https://github.com/kaz-0704/VRGuitar/assets/72312199/e7c9b935-40c9-4213-809f-30ef5ea5eea6)

### 手首の振りを評価するモデル
評価スコアが1-2点，3-4点，5点の3クラスで分類を行った．
![手首の振りモデルの性能](https://github.com/kaz-0704/VRGuitar/assets/72312199/5c846f98-fbed-46d9-bbab-97c87c71f0a6)

### 前腕の振りを評価するモデル
評価スコアが1-2点，3-4点，5点の3クラスで分類を行った．
![前腕の振りモデルの性能](https://github.com/kaz-0704/VRGuitar/assets/72312199/10ce2c0f-124e-4c5e-aba2-6106c44034c1)

